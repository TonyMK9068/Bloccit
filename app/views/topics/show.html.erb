<div class="hero-unit">
<h3><%= @topic.name %></h3>
</div>

<div class="pull-right">
  <div class="btn-group btn-group-vertical">
  <div>
  <% if can? :create, Post %>
    <%= link_to "New Post", new_topic_post_path(@topic), class: 'btn' %>
  <% end %>
</div>

<div>  <% if can? :delete, @topic %>
    <%= link_to "Delete Topic", @topic, method: :delete, class: 'btn', confirm: 'Are you sure you want to delete this topic?' %>
  <% end %></div>
<div><% if can? :update, @topic %>
  <%= link_to "Edit Topic", edit_topic_path, class: 'btn' %>
<% end %></div>
  </div>
</div>

<div class="row">
  <div>
  <p class="lead">  
    <%= @topic.description %>
  </p>
  <% @posts.each do |post| %>
    <div class="media">
    <%= render partial: 'votes/voter', locals: { topic: @topic, post: post } %>

      <div class="media-body">
      <h4 class="media-heading">
        <%= link_to (markdown post.title), [@topic, post] %> 
         <small>submitted <%= time_ago_in_words(post.created_at) %> ago by <%= post.user.name %>
         <%= image_tag(post.user.avatar.tiny.url) if post.user.avatar? %> 
         </small>
      <br/> 
      </h4>
      <small><%= (markdown post.body) %></small>
      
        <% if (post.comments.count > 0) %>
        <small><%= pluralize(post.comments.count, 'Comment') %> </small>
        <% else %>
        <small>No comments yet!</small>
        <% end %> </small>

        <div class="pull-right">
        <%= image_tag(post.image.small) if post.image? %>
        </div>
      </div>
    </div>
    <% end %>
    <%= will_paginate @posts %>
  </div>
</div>
